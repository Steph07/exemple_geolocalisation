<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>Open Street Map - simple map with popup</title>
        <link rel="stylesheet" href="js/CloudMade-Leaflet/dist/leaflet.css" type="text/css" media="screen">
        <!--[if lte IE 8]>
             <link rel="stylesheet" href="js/CloudMade-Leaflet/dist/leaflet.ie.css" />
         <![endif]-->
        
        <script src="js/jquery-2.1.4.min.js"></script>
        <script src="js/CloudMade-Leaflet/dist/leaflet.js" type="text/javascript"></script>
    </head>

    <body>
        <div id="cloudmade-oms-map" style="height: 700px"></div>
        <p>
            <br />
            <button type="button" id="cloudmade-oms-positioning" class="btn">Localiser Paris</button>
        </p>
        <script type="text/javascript" charset="utf-8">
        
        // init tile service with MapQuest
        var tilesService = new L.TileLayer('http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png', {
            attribution: '\
                Data, imagery and map information provided by <a href="http://open.mapquest.co.uk" target="_blank">MapQuest</a>,\
                <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> and contributors,\
                <a href="http://creativecommons.org/licenses/by-sa/2.0/" target="_blank">CC-BY-SA</a>\
            ',
            subdomains : ['otile1','otile2','otile3','otile4'],
            //maxZoom: 18
        });

        // init map
        var map = new L.Map('cloudmade-oms-map', 
            {
                center: [44.912404,4.43767360689655],
                zoom: 17,
                scrollWheelZoom: false
            }
        ).addLayer(tilesService);
    
        // Add circle
        var circle = L.circle([44.912404,4.43767360689655], 50,{
            color: 'red',
            fillColor: '#f03',
            fillOpacity: 0.5
        }).addTo(map);
        // Add popup to marquer
        circle.bindPopup("<b>SimplonVE !</b>").openPopup();

        // Geocode Paris
        $('#cloudmade-oms-positioning').click(function() {
            var _this = this;
            $(this).addClass('btn-warning');
            
            // get position from MapQuest Nominatim service
            $.getJSON(
                'http://open.mapquestapi.com/nominatim/v1/search?format=json&q=Paris,France', 
                function(data) {
                    map.setView([data[0].lat, data[0].lon], 17);
                    $(_this).removeClass('btn-warning').addClass('btn-success');
                }
            );
            return false;
        });
            
        </script>        
    </body>    
</html>
